const editStart=document.querySelector(".order__edit"),deleteElem=document.querySelectorAll(".order__delete"),orderItem=document.querySelectorAll(".order__item"),orderParent=document.querySelector(".order"),itemPrice=document.querySelectorAll(".order__item-price");let totalPrice=document.querySelector(".order__total-price"),totalTaxes=document.querySelector(".order__total-taxes");const totalSum=document.querySelector(".order__total-sum"),toggleEditMode=()=>{deleteElem.forEach(e=>{e.style.cssText="animation: rotation 0.3s",e.classList.toggle("no-display")}),"edit order"===editStart.textContent?editStart.textContent="Save":editStart.textContent="edit order",editStart.addEventListener("click",toggleEditMode)};let totalPriceValue=totalPrice.textContent.slice(1,totalPrice.textContent.length),totalTaxesValue=totalTaxes.textContent.slice(1,totalTaxes.textContent.length);const deleteElement=(e,t)=>{e.parentElement.parentElement.style.cssText="animation: fade 0.5s",setTimeout(()=>{e.parentElement.parentElement.remove()},500);let o=itemPrice[t].textContent;o=o.slice(1,o.length),totalPriceValue=Math.round(totalPriceValue-o),totalTaxesValue=Math.round(totalTaxesValue-4.04),totalPrice.textContent="$"+totalPriceValue,totalTaxes.textContent="$"+totalTaxesValue,totalSum.textContent="$"+ +(totalPriceValue+totalTaxesValue)};editStart.addEventListener("click",toggleEditMode),deleteElem.forEach((e,t)=>{e.addEventListener("click",()=>{deleteElement(e,t)})});const nextBtn=document.querySelectorAll(".next"),formBlock=document.querySelectorAll(".shipping"),wrapper=document.querySelector(".form__wrapper"),inner=document.querySelector(".slides__inner"),stepElem=document.querySelectorAll(".main__step"),width=window.getComputedStyle(inner).width;let offset=0;inner.style.width=100*formBlock.length+"%",inner.style.transition="0.5s all",inner.style.display="flex",wrapper.style.overflow="hidden",formBlock.forEach(e=>{e.style.width=width});const confirmationWindow=document.querySelector(".confirmation"),rejectConfirmation=document.querySelector(".confirmation__no"),acceptConfirmation=document.querySelector(".confirmation__yes"),closeConfirmation=document.querySelector(".confirmation__close"),closeConfirmationWindow=()=>{confirmationWindow.style.cssText="animation: fade 0.5s",setTimeout(()=>{confirmationWindow.style.display="none"},400)};closeConfirmation.addEventListener("click",()=>{closeConfirmationWindow()}),rejectConfirmation.addEventListener("click",()=>{closeConfirmationWindow()}),acceptConfirmation.addEventListener("click",()=>{closeConfirmationWindow(),fetch("https://api.ipdata.co?api-key=test").then(e=>{e.json().then(e=>{console.log(e),document.querySelector("#shopping_country").value=e.country_name,phone.forEach(t=>{new IMask(t,{mask:`+{${e.calling_code}}(00)000-00-00`})}),document.querySelector("#shopping_city").value=e.city,document.querySelector("#shipping-zip").value=e.postal})})}),nextBtn.forEach((e,t)=>{e.addEventListener("click",o=>{o.preventDefault();let n=!0;if(document.querySelectorAll(".shipping__form")[t].querySelectorAll(".input").forEach(e=>{!1===e.checkValidity()&&(n=!1)}),n)o.target===nextBtn[2]&&bindpostData(document.querySelector("#form")),offset===+width.slice(0,width.length-2)*(formBlock.length-1)?offset=0:offset+=+width.slice(0,width.length-2),formBlock[t+1].classList.remove("hidden"),setTimeout(()=>{formBlock[t].classList.add("hidden")},300),inner.style.transform=`translateX(-${offset}px)`;else{const t=document.createElement("div");t.style.color="red",t.textContent="Please, fill in all the fields!",e.parentElement.appendChild(t),setTimeout(()=>{e.parentElement.removeChild(t)},1500)}})}),stepElem.forEach((e,t)=>{e.addEventListener("click",t=>{const o=t.target.getAttribute("data-slide-to");document.querySelectorAll(".shipping"),e.parentElement.querySelectorAll(".main__step")[o].classList.contains("text-active")&&(offset=+width.slice(0,width.length-2)*o,formBlock[o].classList.remove("hidden"),setTimeout(()=>{formBlock[o-1].classList.add("hidden")},300),inner.style.transform=`translateX(-${offset}px)`)})});const phone=document.querySelectorAll(".phone"),countryShipping=document.querySelector("#shopping_country"),cardNumber=document.querySelector("#payment_card"),cardDate=document.querySelector("#payment_date"),cardCode=document.querySelector("#payment_code");new IMask(cardNumber,{mask:"0000 0000 0000 0000"}),new IMask(cardDate,{mask:"00/00"}),new IMask(cardCode,{mask:"000"});const postData=async(e,t)=>{const o=await fetch(e,{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:t});return await o.json()};function bindpostData(e){const t=new FormData(e),o=JSON.stringify(Object.fromEntries(t.entries()));postData("https://jsonplaceholder.typicode.com/posts",o).then(e=>{console.log(e),editStart.style.visibility="hidden",window.scrollTo(0,0),document.querySelectorAll(".shipping")[2].style.display="none";const t=document.createElement("div");t.innerHTML=`<div class="bill">\n    <h1 class="form__heading">Thank you for your order!</h1>\n    <p><b>Order number is: 172837837128</b></p>\n    <p>You will receive an email confirmation shortly to <a href="#"><span id="bill-email">${e.billing_email}</span></a></p>\n    <p>Estimated delivery day is <br><b>Friday 1st April 2016</b></p>\n    <button><a href="#">print recipe</a></button>\n</div>`,document.querySelector(".main__content").appendChild(t)}).catch(()=>{})}const sameAsShippingBtn=document.querySelector(".form__heading-button");sameAsShippingBtn.addEventListener("click",()=>{document.querySelector("#billing_name").value=document.querySelector("#shipping-name").value,document.querySelector("#billing_country").value=document.querySelector("#shopping_country").value,document.querySelector("#billing-zip").value=document.querySelector("#shipping-zip").value,document.querySelector("#billing_ad_address").value=document.querySelector("#shipping_ad_address").value,document.querySelector("#billing_address").value=document.querySelector("#shipping_address").value,document.querySelector("#billing_city").value=document.querySelector("#shopping_city").value});const billEmail=document.querySelector("#bill-email");billEmail.textContent=document.querySelector("#billing_email").value;